[
  {
    "id": "LOG-001",
    "title": "Missing ECS format support in Winston configuration",
    "severity": "high",
    "category": "logger-baseline",
    "evidence": "winston.config.ts uses basic JSON format without ECS field structure. Missing @timestamp, event.*, http.*, url.*, trace.* fields required for observability.",
    "recommendation": "Implement ECS-compliant Winston formatter with required fields (@timestamp, log.level, message, event.dataset, service.name). Add enrichers for process.pid, host.hostname, and environment context.",
    "owner": "backend-team",
    "effort": "medium"
  },
  {
    "id": "LOG-002", 
    "title": "No request context propagation or tracing",
    "severity": "high",
    "category": "logger-baseline",
    "evidence": "No AsyncLocalStorage implementation for request correlation. Missing requestId, spanId, userId tracking across service calls.",
    "recommendation": "Implement packages/web/src/lib/logger/context.ts with AsyncLocalStorage for Node runtime. Provide withRequestContext() wrapper and getContext() helper.",
    "owner": "backend-team",
    "effort": "medium"
  },
  {
    "id": "LOG-003",
    "title": "Console.* usage in production code paths",
    "severity": "medium", 
    "category": "console-usage",
    "evidence": "25+ console.error calls in services (cart.service.ts: 8 instances, catalog.service.ts: 3 instances) and API routes. These bypass structured logging and lack context.",
    "recommendation": "Replace console.error with logger.error systematically. Start with high-traffic services (cart, catalog). Add structured context (userId, requestId, error type).",
    "owner": "backend-team",
    "effort": "high"
  },
  {
    "id": "LOG-004",
    "title": "Missing request/response logging middleware", 
    "severity": "medium",
    "category": "observability-gaps",
    "evidence": "20+ API routes lack systematic request timing, status logging. No standardized error handling logging across routes.",
    "recommendation": "Implement packages/web/src/app/api/_logging/withLogging.ts wrapper for Node runtime route handlers. Include start/end timing, HTTP context, error capture.",
    "owner": "backend-team", 
    "effort": "medium"
  },
  {
    "id": "LOG-005",
    "title": "No environment flag control for logging",
    "severity": "medium",
    "category": "logger-baseline", 
    "evidence": "Missing LOG_ENABLED, LOG_FORMAT, LOG_SAMPLING environment variable support. Cannot disable logging or control output format per environment.",
    "recommendation": "Add env flag checks in winston.config.ts: LOG_ENABLED (boolean), LOG_FORMAT (ecs|human), LOG_SAMPLING (0-1 float). Implement no-op logger when disabled.",
    "owner": "backend-team",
    "effort": "low"
  },
  {
    "id": "LOG-006",
    "title": "Missing performance monitoring logs",
    "severity": "low",
    "category": "observability-gaps",
    "evidence": "No slow query detection (>300ms), no external API call timing (OpenAI), no database operation monitoring.",
    "recommendation": "Add performance thresholds in service layer. Log slow operations with timing context. Monitor external dependencies (OpenAI API, MongoDB) with response times.",
    "owner": "backend-team",
    "effort": "medium"
  },
  {
    "id": "LOG-007", 
    "title": "PII redaction limited to basic patterns",
    "severity": "medium",
    "category": "security",
    "evidence": "winston.config.ts has RegExp patterns for email, phone, SSN, credit cards. Missing comprehensive key-based redaction for nested objects and configurable redaction keys.",
    "recommendation": "Enhance redaction with LOG_REDACT_KEYS environment variable. Implement deep object traversal for nested PII. Add truncation for oversized payloads (>10KB).",
    "owner": "security-team",
    "effort": "medium"
  },
  {
    "id": "LOG-008",
    "title": "No Edge runtime logging strategy",
    "severity": "low", 
    "category": "observability-gaps",
    "evidence": "Winston only works in Node runtime. No documented fallback strategy for Edge middleware or Edge API routes.",
    "recommendation": "Document Edge runtime limitations. Provide minimal JSON console fallback when LOG_ENABLED=true. Advise moving critical observability to Node runtime.",
    "owner": "backend-team",
    "effort": "low"
  },
  {
    "id": "LOG-009",
    "title": "Missing domain event logging",
    "severity": "low",
    "category": "observability-gaps", 
    "evidence": "No structured logging for business events: cart additions, purchases completed, user registrations, catalog changes.",
    "recommendation": "Add domain event logging in service layer with event.action field: 'cart.item_added', 'purchase.completed', 'user.registered'. Include relevant entity IDs (hashed).",
    "owner": "product-team",
    "effort": "medium"
  },
  {
    "id": "LOG-010",
    "title": "No ESLint enforcement for console usage",
    "severity": "low",
    "category": "developer-experience",
    "evidence": "No eslint no-console rule enabled. Developers can accidentally introduce console.* calls without review.",
    "recommendation": "Enable ESLint no-console rule with allowlist for logger modules. Add quick-fix documentation for console.* â†’ logger.* replacements.",
    "owner": "platform-team", 
    "effort": "low"
  }
]